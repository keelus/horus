<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="/static/sass/compilado/panel.css">
	<link rel="shortcut icon" href="/static/images/favicon.ico" type="image/x-icon">
	<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
	

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.contextMenu.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.contextMenu.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.7.1/jquery.ui.position.js"></script>


	{{ if eq .Active "LedControl" }}
		<title>Led Control :: Horus</title>
	{{ else if eq .Active "Statistics"}}
		<title>System stats :: Horus</title>
	{{ else if eq .Active "Settings"}}
		<title>Settings :: Horus</title>
	{{ end }}
</head>
<body class="noSelect">
	<h1 class="title"><a href="/">Horus</a></h1>
	<h2 class="subtitle">v{{.UserConfiguration.Version}}</h2>
	<div class="cuerpo">
		<div class="leftNav">
			<a class="elemento perfil">
				<div class='avatar' style="background-image:url('/static/images/avatar.jpg{{fPreventCaching}}')"></div>
				<div class="textos">
					<div class="nombre">keelus</div>
					<div class="accion">Online</div>
				</div>
			</a>
			<a class="elemento" href="/panel/LedControl">
				<div class="icono">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="var(--svg)"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-2 19l1.5-5h-4.5l7-9-1.5 5h4.5l-7 9z"/></svg>
				</div>
				<div class="texto">Led control</div>
			</a>
			<a class="elemento" href="/panel/Statistics">
				<div class="icono">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="var(--svg)"><path d="M13 12.414v-12.364c6.158.51 11 5.66 11 11.95 0 6.627-5.373 12-12 12-2.953 0-5.654-1.072-7.744-2.842l8.744-8.744zm-2-12.364c-6.158.51-11 5.66-11 11.95 0 2.954 1.072 5.654 2.842 7.745l1.42-1.42c-1.412-1.725-2.262-3.928-2.262-6.325 0-5.177 3.953-9.446 9-9.949v-2.001z"/></svg>
				</div>
				<div class="texto">System stats</div>
			</a>
			<a class="elemento" href="/panel/Settings">
				<div class="icono">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"  fill="var(--svg)"><path d="M19 2c1.654 0 3 1.346 3 3v14c0 1.654-1.346 3-3 3h-14c-1.654 0-3-1.346-3-3v-14c0-1.654 1.346-3 3-3h14zm5 3c0-2.761-2.238-5-5-5h-14c-2.762 0-5 2.239-5 5v14c0 2.761 2.238 5 5 5h14c2.762 0 5-2.239 5-5v-14zm-13 12h-2v3h-2v-3h-2v-3h6v3zm-2-13h-2v8h2v-8zm10 5h-6v3h2v8h2v-8h2v-3zm-2-5h-2v3h2v-3z"/></svg>
				</div>
				<div class="texto">Settings</div>
			</a>
			<a class="elemento" href="/back/logout">
				<div class="icono">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="var(--rojo)"><path d="M16 12.771h-3.091c-.542 0-.82-.188-1.055-.513l-1.244-1.674-2.029 2.199 1.008 1.562c.347.548.373.922.373 1.42v4.235h-1.962v-3.981c-.016-1.1-1.695-2.143-2.313-1.253l-1.176 1.659c-.261.372-.706.498-1.139.498h-3.372v-1.906l2.532-.001c.397 0 .741-.14.928-.586l1.126-2.75c.196-.41.46-.782.782-1.102l2.625-2.6-.741-.647c-.223-.195-.521-.277-.812-.227l-2.181.381-.342-1.599 2.992-.571c.561-.107 1.042.075 1.461.462l2.882 2.66c.456.414.924 1.136 1.654 2.215.135.199.323.477.766.477h2.328v1.642zm-2.982-5.042c1.02-.195 1.688-1.182 1.493-2.201-.172-.901-.96-1.528-1.845-1.528-1.186 0-2.07 1.078-1.85 2.234.196 1.021 1.181 1.69 2.202 1.495zm4.982-5.729v15l6 5v-20h-6z"/></svg>
				</div>
				<div class="texto">Log out</div>
			</a>


		</div>
		<div class="rightNav">
			{{ if eq .Active "main" }}
				Choose an option.
			{{ else if eq .Active "LedControl" }}
				<div class="ledControlPane">
					<div class="title"><div class="icono"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--svg)"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-2 19l1.5-5h-4.5l7-9-1.5 5h4.5l-7 9z"/></svg></div>Led control</div>
					<div class="option active">
						<div class="checkLine">
							<input type="radio" name="ledOption" id="staticColor" checked> <label for="staticColor" class="text">Static color</label>
						</div>
						<div class="content">
							<!-- <input type="color" value="{{.CurrentLED}}"> -->
							<div class="colors">
								<div class="color" style="background-color:aqua"><div class="delete">x</div></div>
								<div class="color" style="background-color:brown"><div class="delete">x</div></div>
								<div class="color" style="background-color:coral"><div class="delete">x</div></div>
								<div class="color" style="background-color:darkmagenta"><div class="delete">x</div></div>
								<div class="color selected" style="background-color:aqua"><div class="delete">x</div></div>
								<div class="color" style="background-color:brown"><div class="delete">x</div></div>
								<div class="color" style="background-color:coral"><div class="delete">x</div></div>
								<div class="color" style="background-color:darkmagenta"><div class="delete">x</div></div>
								<div class="color" style="background-color:aqua"><div class="delete">x</div></div>
								<div class="color" style="background-color:brown"><div class="delete">x</div></div>
								<div class="color" style="background-color:coral"><div class="delete">x</div></div>
								<div class="color" style="background-color:darkmagenta"><div class="delete">x</div></div>
								<div class="color" style="background-color:aqua"><div class="delete">x</div></div>
								<div class="color" style="background-color:brown"><div class="delete">x</div></div>
								<div class="color" style="background-color:coral"><div class="delete">x</div></div>
								<div class="color" style="background-color:darkmagenta"><div class="delete">x</div></div>
								<div class="color new">+</div>
							</div>
						</div>
					</div>
					{{if index .UserConfiguration.LedControl 0}}
						<div class="option">
							<div class="checkLine">
								<input type="radio" name="ledOption" id="rainbow"> <label for="rainbow" class="text">Rainbow</label>
							</div>
							<div class="content">##</div>
						</div>
					{{end}}
					{{if index .UserConfiguration.LedControl 1}}
						<div class="option">
							<div class="checkLine">
								<input type="radio" name="ledOption" id="smoothGradient"> <label for="smoothGradient" class="text">Smooth gradient</label>
							</div>
							<div class="content">##2</div>
						</div>
					{{end}}
					<button class="botonGuardar">Save changes</button>
				</div>
			{{ else if eq .Active "Statistics"}}
				<div class="systemStatsPane">
					<div class="title"><div class="icono"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="var(--svg)"><path d="M13 12.414v-12.364c6.158.51 11 5.66 11 11.95 0 6.627-5.373 12-12 12-2.953 0-5.654-1.072-7.744-2.842l8.744-8.744zm-2-12.364c-6.158.51-11 5.66-11 11.95 0 2.954 1.072 5.654 2.842 7.745l1.42-1.42c-1.412-1.725-2.262-3.928-2.262-6.325 0-5.177 3.953-9.446 9-9.949v-2.001z"/></svg></div>System stats</div>
					
					{{- if index .UserConfiguration.SystemStats 0 -}}
						Temperature:	50C <br>
					{{- end -}}
					{{- if index .UserConfiguration.SystemStats 1 -}}
						CPU usage: 		23% <br>
					{{- end -}}
					{{- if index .UserConfiguration.SystemStats 2 -}}
						RAM usage:		10% <br>
					{{- end -}}
					{{- if index .UserConfiguration.SystemStats 3 -}}
						Disk Space:		40GB <br>
					{{- end -}}
					{{- if index .UserConfiguration.SystemStats 4 -}}
						System uptime:	4 days
					{{- end -}}
				</div>
			{{ else if eq .Active "Settings"}}
				<div class="settingsPane">
					<div class="title" style="margin-bottom: 10px;"><div class="icono"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"  fill="var(--svg)"><path d="M19 2c1.654 0 3 1.346 3 3v14c0 1.654-1.346 3-3 3h-14c-1.654 0-3-1.346-3-3v-14c0-1.654 1.346-3 3-3h14zm5 3c0-2.761-2.238-5-5-5h-14c-2.762 0-5 2.239-5 5v14c0 2.761 2.238 5 5 5h14c2.762 0 5-2.239 5-5v-14zm-13 12h-2v3h-2v-3h-2v-3h6v3zm-2-13h-2v8h2v-8zm10 5h-6v3h2v8h2v-8h2v-3zm-2-5h-2v3h2v-3z"/></svg></div>Horus settings</div>
					<div class="categories">
						<div class="category UserInfo" category="UserInfo">
							<div class="title">User info</div>
							<div class="details">Change your user info and password.</div>
							<div class="content">
								<div class="inputBox">
									<div class="text">Username:</div>
									<div><input type="text" placeholder="Your new username" value="{{ .UserConfiguration.UserInfo.Username}}" id="userInfo0"></div>
								</div>
								<div class="inputBox">
									<div class="text" style="padding-bottom:1.2em">Password:</div>
									<div style="width:100%;">
										<div  style="width:100%;">
											<input type="password" placeholder="Your new password" id="userInfo1"  style="width:80%;"> <br>
											<span style="font-size:.7em;line-height:.7em;">Leave empty if not changing.</span>
										</div>
									</div>
								</div>
								<div class="inputBox" style="margin-top:1em;">
									<div class="text">Avatar:</div>
									<div><div class="avatar" style="background-image: url('/static/images/avatar.jpg{{fPreventCaching}}');"></div><span class="note"><- Replace the file on "static/images/avatar.jpg" <br> to change <i>[.jpg, .png, .webp, .gif]</i>. No need to apply.</span></div>
								</div>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category SessionSettings" category="SessionSettings">
							<div class="title">Session settings</div>
							<div class="details">Choose your preferred session-cookie lifetime span.</div>
							<div class="content">
								<input type="radio" name="sessionDurationType" id="sessionDuration0" {{if eq .UserConfiguration.SessionSettings.Lifespan -1}}checked{{end}}> <label for="sessionDuration0">Browser close</label><br>
								<div class="inputBox">
									<div class="text">
										<input type="radio" name="sessionDurationType" id="sessionDuration1" {{if ne .UserConfiguration.SessionSettings.Lifespan -1}}checked{{end}}>
										<label for="sessionDuration1">Specific:</label>
									</div>
									<div>
										<input type="number" id="sessionDuration2" placeholder="An integer. (e.g., 365)" {{if ne .UserConfiguration.SessionSettings.Lifespan -1}}value="{{.UserConfiguration.SessionSettings.Lifespan}}"{{end}}>
										&nbsp;
										<select id="sessionDuration3">
											<option value="min" {{if eq .UserConfiguration.SessionSettings.Unit "min"}}selected{{end}}>minutes</option>
											<option value="hour" {{if eq .UserConfiguration.SessionSettings.Unit "hour"}}selected{{end}}>hours</option>
											<option value="day" {{if eq .UserConfiguration.SessionSettings.Unit "day"}}selected{{end}}>days</option>
										</select>
									</div>
								</div>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category LedControl" category="LedControl">
							<div class="title">Led Control</div>
							<div class="details">Choose what options you want to see in <b>Led Control</b> tab.</div>
							<div class="content">
								<input type="checkbox" disabled checked> <label for="">Show static</label><br>
								<input type="checkbox" id="ledControl0" {{if index .UserConfiguration.LedControl 0 }}checked{{end}}> <label for="ledControl0">Show rainbow</label><br>
								<input type="checkbox" id="ledControl1" {{if index .UserConfiguration.LedControl 1 }}checked{{end}}> <label for="ledControl1">Show slow gradient</label>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category SystemStats" category="SystemStats">
							<div class="title">System stats</div>
							<div class="details">Choose what options you want to see in <b>System stats</b> tab.</div>
							<div class="content">
								<input type="checkbox" id="systemStats0" {{if index .UserConfiguration.SystemStats 0 }}checked{{end}}> <label for="systemStats0">Show temperature</label><br>
								<input type="checkbox" id="systemStats1" {{if index .UserConfiguration.SystemStats 1 }}checked{{end}}> <label for="systemStats1">CPU usage</label><br>
								<input type="checkbox" id="systemStats2" {{if index .UserConfiguration.SystemStats 2 }}checked{{end}}> <label for="systemStats2">RAM usage</label><br>
								<input type="checkbox" id="systemStats3" {{if index .UserConfiguration.SystemStats 3 }}checked{{end}}> <label for="systemStats3">Disk Space</label><br>
								<input type="checkbox" id="systemStats4" {{if index .UserConfiguration.SystemStats 4 }}checked{{end}}> <label for="systemStats4">System uptime</label><br>
								<span class="note">If no stat is shown, the tab will dissapear from the left navigator. To show it, you must show at least 1 system stat.</span>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category Logging" category="Logging">
							<div class="title">Logging</div>
							<div class="details">Choose wether to log or not the user access, settings changes, etc.</div>
							<div class="content">
								<input type="checkbox" id="logging0" {{if .UserConfiguration.Logging }}checked{{end}}> <label for="logging0">Enabled/disabled</label>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category Security" category="Security">
							<div class="title">Security</div>
							<div class="details">Choose wether to show another text field asking for a username [increased security] or to just prompt your password.</div>
							<div class="content">
								<input type="checkbox" id="security0" {{if .UserConfiguration.Security.UserInput }}checked{{end}}> <label for="security0">User has to input username on login</label>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						<div class="category Units" category="Units">
							<div class="title">Units</div>
							<div class="details">Choose your preferred visual settings.</div>
							<div class="content">
								<div class="inputBox">
									<div class="text">Time mode:</div>
									<div>
										<select id="units0" style="min-width:120px;">
											<option value="12" {{if .UserConfiguration.Units.TimeMode12}}selected{{end}}>12 hour</option>
											<option value="24" {{if not .UserConfiguration.Units.TimeMode12}}selected{{end}}>24 hour</option>
										</select>
									</div>
								</div>
								<div class="inputBox">
									<div class="text">Temperature:</div>
									<div>
										<select id="units1" style="min-width:120px;">
											<option value="C" {{if .UserConfiguration.Units.TemperatureC}}selected{{end}}>Celsius</option>
											<option value="F" {{if not .UserConfiguration.Units.TemperatureC}}selected{{end}}>Farenheit</option>
										</select>
									</div>
								</div>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category Design" category="Design">
							<div class="title">Design & personalization</div>
							<div class="details">Here you can change Horus' color theme, fonts, and other visuals.</div>
							<div class="content">
								- Accent[s]:<br>
								<ul>
									{{ range $i, $color := .UserConfiguration.Design.Accent}}
										<li>{{$color}}</li>
									{{end}}
								</ul>
								- Fonts<br>
								&nbsp;&nbsp;- Base: {{(index .UserConfiguration.Design.Fonts 0).Title}} -> <a href="{{(index .UserConfiguration.Design.Fonts 0).Source}}" target="_blank" class="render-link">source</a><br>
								&nbsp;&nbsp;- Code: {{(index .UserConfiguration.Design.Fonts 1).Title}} -> <a href="{{(index .UserConfiguration.Design.Fonts 1).Source}}" target="_blank" class="render-link">source</a><br>
							</div>
							<button class="botonGuardar">Apply changes</button>
						</div>
						
						<div class="category Updates" category="Updates">
							<div class="title">Updates</div>
							<div class="content" style="padding-bottom:5px;">
								Installed version: v{{.UserConfiguration.Version}} - {{if not .UsingLatest}}❌ Not latest{{else}}✅ Latest{{end}}<br>
								{{if not .UsingLatest}}
									Latest version: v{{.LatestVersion}} - <a href="#" class="render-link">See new version & installation</a> <br> <br>
								{{end}}
								Lastest check: Right now
							</div>
						</div>
						
						<div class="category Deletion" category="Deletion">
							<div class="title">Deletion</div>
							<div class="details">Delete all your Horus data [user info, configuration, personalization, and logs]. The script execution will come to the first-time execution. Irreversible</div>
							<div class="content">
							</div>
							<button class="botonGuardar">Delete</button>
						</div>
					</div>
					
					
				</div>
			{{ end }}
		</div>
	</div>
</body>
</html>



<script>
	$(".botonGuardar").on("click", (e) => {
		category = $(e.target).closest(".category").attr("category")
		$(`[category='${category}']`).find(".hasError").removeClass("hasError")

		postData = {}

		switch(category) {
		case "UserInfo":
			postData.Username = $("#userInfo0").val()
			postData.Password = $("#userInfo1").val()
			break
		case "SessionSettings":
			activeRadio = $('input[name="sessionDurationType"]:checked').attr("id")
			if(activeRadio == "sessionDuration0"){
				postData.Lifespan = -1
				postData.Unit = ""
			} else {
				postData.Lifespan = $("#sessionDuration2").val()
				postData.Unit = $("#sessionDuration3").val()
			}
			break
		case "LedControl":
			postData.LedControl = JSON.stringify([$("#ledControl0").prop("checked"),$("#ledControl0").prop("checked")])
			break
		case "SystemStats":
			postData.SystemStats = JSON.stringify([$("#systemStats0").prop("checked"), $("#systemStats1").prop("checked"),
									$("#systemStats2").prop("checked"), $("#systemStats3").prop("checked"), $("#systemStats4").prop("checked")])
			break
		case "Logging":
			postData.Logging = $("#logging0").prop("checked")
			break
		case "Security":
			postData.UserInput = $("#security0").prop("checked")
			break
		case "Units":
			postData.TimeMode = $("#units0").val()
			postData.Temperature = $("#units1").val()
			break
		case "Design":
			// TODO
			break
		case "Deletion":
			// TODO
			break
		}

		
		$.ajax({
			type: "POST",
			url: `/back/saveConfiguration/${category}`,
			data: postData,
			success: function (r) {
				console.log("ok")
			},
			error: function(r) {
				console.log(r)
				for(i=0;i<r.responseJSON.length;i++){
					console.error(r.responseJSON[i].details)

					field = r.responseJSON[i].field
					if(field != "") {
						$(`#${field}`).addClass("hasError")
					}
				}
			}
		});
	})
	


</script>